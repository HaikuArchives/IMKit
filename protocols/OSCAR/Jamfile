#
# Copyright 2008, IM Kit Team.
# Distributed under the terms of the MIT License.
#
# Authors:
#		Pier Luigi Fiorini <pierluigi.fiorini@gmail.com>
#

SubDir TOP protocols OSCAR ;

SubDirHdrs [ FDirName $(TOP) ] ;
SubDirHdrs [ FDirName $(IMKIT_OPENSSL_INCDIR) ] ;

SEARCH_SOURCE += [ FDirName $(TOP) common ] ;

AddOn aim :
	AIM.cpp
	FLAP.cpp
	TLV.cpp
	OSCARManager.cpp
	SNAC.cpp
	OSCARConnection.cpp
	OSCARBOSConnection.cpp
	OSCARReqConn.cpp
	Buddy.cpp
	Group.cpp
	: be $(TARGET_LIBSTDC++) textencoding libcommon.a libim.so crypto
	: AIM.rdef AIMProtocolTemplate.rdef
;

Depends aim : libcommon.a ;
Depends aim : libim.so ;

AddOn icq :
	ICQ.cpp
	FLAP.cpp
	TLV.cpp
	OSCARManager.cpp
	SNAC.cpp
	OSCARConnection.cpp 
	OSCARBOSConnection.cpp
	OSCARReqConn.cpp
	Buddy.cpp
	Group.cpp
	: be $(TARGET_LIBSTDC++) textencoding libcommon.a libim.so crypto
	: ICQ.rdef ICQProtocolTemplate.rdef
;

Depends icq : libcommon.a ;
Depends icq : libim.so ;

if $(IMKIT_IS_HAIKU)  = 1 {
	LINKFLAGS on aim += -lnetwork ;
	LINKFLAGS on icq += -lnetwork ;
}

if $(IMKIT_IS_BEOS) = 1 {
	LINKFLAGS on aim += -lsocket ;
	LINKFLAGS on icq += -lsocket ;
}

if $(IMKIT_IS_ZETA) = 1 {
	LINKFLAGS on aim += -lsocket -lbind ;
	LINKFLAGS on icq += -lsocket -lbind ;
	SubDirHdrs /boot/develop/headers/be/bone ;
}

LINKFLAGS on aim += -L$(IMKIT_OPENSSL_LIBDIR) ;
LINKFLAGS on icq += -L$(IMKIT_OPENSSL_LIBDIR) ;

InstallLib $(IMKIT_COMMON_ADDONS_DIRECTORY)/im_kit/protocols : aim ;
InstallLib $(IMKIT_COMMON_ADDONS_DIRECTORY)/im_kit/protocols : icq ;

if $(IMKIT_IS_ZETA) = 1 {
	SVGIcon aim : [ FDirName $(TOP) icons imkit protocols AIM.svg ] ;
	SVGIcon icq : [ FDirName $(TOP) icons imkit protocols ICQ.svg ] ;
}

Package imkit :
	aim :
	[ FSplitPath $(IMKIT_COMMON_ADDONS_DIRECTORY)/imkit/protocols ]
;
Package imkit :
	icq :
	[ FSplitPath $(IMKIT_COMMON_ADDONS_DIRECTORY)/imkit/protocols ]
;
